import veryfi
from veryfi import Client

def OCR_Verify_Model(file):
    client_id = 'vrf6pMi7j1FTf5tjah2VlYJVMsZKclRld2suTj7'
    client_secret = 'YU8v3P20cKgduTDHBiE2Rn8XIOFdROmOc1N51YVaGazHtCFtRZMh01gTbSsXukcRVhzk2EOWHV7hrHbIEkO1J7smsenE2cPDpWIjjVoEOX2m5rlhwAMs1wHF6IiP2TVz'
    username = 'adelhadeer436'
    api_key = 'c232f4ffffcefeb3b9f6ef45a99bb58f'

    categories = ['Grocery', 'Utilities', 'Travel']
    file_path = file

    veryfi_client = Client(client_id, client_secret, username, api_key)
    response = veryfi_client.process_document(file_path, categories=categories)

    # Accessing and printing the ocr_text with corrected spacing
    ocr_text = response['ocr_text']
    lines = ocr_text.split('\n')

    student_id = ""
    student_name = ""
    student_answer = ""

    for i, line in enumerate(lines):
        stripped_line = line.replace(' ', '').strip()
        if 'ID' in line:
            # Check if ID is on the same line
            id_line = line.replace('ID', '').strip()
            student_id = id_line
            # Check if ID is on the previous line
            if i > 0:
                prev_line = lines[i - 1].replace(' ', '').strip()
                if prev_line.isdigit():
                    student_id = lines[i - 1].strip()
        if 'Name' in line:
            student_name = line.split('Name', 1)[1].strip()
        if 'Answer' in line:
            student_answer = line.split('Answer', 1)[1].strip()
            continue
        student_answer += " " +line.strip() + "\n"


    return student_id.replace(' ',''), student_name, student_answer
